<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Home</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="../style.css" />
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Stack+Sans+Notch:wght@200..700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css"
    integrity="sha512-vKMx8UnXk60zUwyUnUPM3HbQo8QfmNx7+ltw8Pm5zLusl1XIfwcxo8DbWCqMGKaWeNxWA8yrx5v3SaVpMvR3CA=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/css/all.min.css"
    integrity="sha512-2SwdPD6INVrV/lHTZbO2nodKhrnDdJK9/kg2XD1r9uGqPo1cUbujc+IYdlYdEErWNu69gVcYgdxlmVmzTWnetw=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />
</head>

<body>
  <div class="main-container">
    <div class="row">
      <div class="col-lg-2">
        <div class="row sidebar">
          <div class="col-lg-12 text-center">
            <a style="text-decoration: none;" href="../index.html">
              <h2 class="logo">FileShare</h2>
            </a>
          </div>
          <div class="divider"></div>
          <div class="col-lg-12 menu">
            <div class="col-lg-12">
              <a class="row menu-link" onclick="showMenu(1)">
                <div class="col-lg-9"><span><i class="fa-solid fa-house-laptop"></i></span> <span
                    style="padding-left: 5%;">Home</span></div>
                <div id="menu-link-1" data-status="0" class="col-lg-2"><i class="fa-solid fa-angles-right"></i> </div>
              </a>

            </div>
            <div id="menu-content-1" style="display: none;" class="col-lg-10 menu-content">
              <a class="menu-item col-lg-12">
                <span><i class="fa-solid fa-minus"></i> <span style="padding-left: 5%;">Dashboard</span>
              </a>
            </div>
          </div>

          <div class="col-lg-12 menu">
            <div class="col-lg-12">
              <a class="row menu-link" onclick="showMenu(2)">
                <div class="col-lg-9"><span><i class="fa-solid fa-house-laptop"></i></span> <span
                    style="padding-left: 5%;">Folder</span></div>
                <div id="menu-link-2" data-status="0" class="col-lg-2"><i class="fa-solid fa-angles-right"></i> </div>
              </a>

            </div>
            <div id="menu-content-2" style="display: none;" class="col-lg-10 menu-content">
              <div class="row col-lg-12">
                <a href="../folder/create.html" class="menu-item col-lg-12">
                  <span><i class="fa-solid fa-minus"></i> <span style="padding-left: 5%;">Add New Folder</span>
                </a>
                <a href="../folder/all.html" class="menu-item col-lg-12">
                  <span><i class="fa-solid fa-minus"></i> <span style="padding-left: 5%;">List All</span>
                </a>
              </div>
            </div>
          </div>

          <div class="col-lg-12 menu">
            <div class="col-lg-12">
              <a class="row menu-link" onclick="showMenu(3)">
                <div class="col-lg-9"><span><i class="fa-solid fa-house-laptop"></i></span> <span
                    style="padding-left: 5%;">Home</span></div>
                <div id="menu-link-3" data-status="0" class="col-lg-2"><i class="fa-solid fa-angles-right"></i> </div>
              </a>

            </div>
            <div id="menu-content-3" style="display: none;" class="col-lg-10 menu-content">

            </div>
          </div>
        </div>
      </div>
      <div class="col-lg-10 main" style="
            margin-left: 0px;
            margin-right: 0px;
            padding-left: 0px;
            padding-right: 0px;
          ">
        <div class="main-navbar col-lg-12 row">
          <div class="col-lg-6">
            <div class="row col-lg-12">
              <div class="col-lg-1"><i style="font-size: 20px;padding-top: 10px;" class="fa-solid fa-bars"></i></div>
              <div class="col-lg-5">
                <div class="input-group mb-3">
                  <span class="input-group-text" id="basic-addon1" style="background-color:white;"><i
                      class="fa-solid fa-magnifying-glass"></i></span>
                  <input type="text" class="form-control" placeholder="Username" aria-label="Username"
                    aria-describedby="basic-addon1">
                </div>
              </div>
            </div>

          </div>
          <div class="col-lg-6">

          </div>
        </div>

        <div class="row main-container"
          style="padding:20px;border-radius:20px ;width: 98%;height: 1000px;background-color: white;margin-top:100px;margin-left: 10px;margin-right: 10px;margin-bottom: 20px;">
          <div class="col-lg-12 row">
            <h2 class="content-title">Create New Folder</h2>
            <div class="col-lg-6">
              <label for="file-name" class="form-label">Folder Name</label>
              <input type="text" id="file-name" class="form-control" placeholder="Enter folder name..." />
            </div>
            <div class="col-lg-6" style="margin-top:32px;">
              <button type="button" class="btn btn-primary" onclick="CreateFolder()">
                <i class="fa-solid fa-folder-plus"></i> Create Folder
              </button>
            </div>
          </div>
          <!-- <div class="col-lg-12 row" style="margin-top:20px;">
              
            </div> -->
          <!-- <div class="col-lg-12 row" style="margin-top:20px;">
              
            </div> -->






        </div>


      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI"
    crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.js"
    integrity="sha512-+k1pnlgt4F1H8L7t3z95o3/KO+o78INEcXTbnoJQ/F2VqDVhWoaiVml/OEHv9HsVgxUaVW+IbiZPUJQfF/YxZw=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"
    integrity="sha512-VEd+nq25CkR676O+pLBnDW09R7VQX9Mdiij052gVCp5yVH3jGtH70Ho/UUv4mJDsEdTvqRCFZg0NKGiojGnUCw=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.1/js/all.min.js"
    integrity="sha512-6BTOlkauINO65nLhXhthZMtepgJSghyimIalb+crKRPhvhmsCdnIuGcVbR5/aQY2A+260iC1OPy1oCdB6pSSwQ=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script>
    function showMenu(id) {
      let dropdown = document.getElementById("menu-link-" + id);
      let status = dropdown.dataset.status;
      if (status == 0) {
        document.getElementById("menu-link-" + id).innerHTML = '<i  class="fa-solid fa-angles-down"></i>';
        document.getElementById("menu-link-" + id).dataset.status = 1
        document.getElementById("menu-content-" + id).style.display = "flex";

      }
      else {
        document.getElementById("menu-link-" + id).innerHTML = '<i  class="fa-solid fa-angles-right"></i>'
        document.getElementById("menu-link-" + id).dataset.status = 0
        document.getElementById("menu-content-" + id).style.display = "none";
      }
    }

    window.onload = async function () {
      const token = localStorage.getItem("token");
      if (!token) {
        window.location.href = "../login.html";
        return;
      }

      let checkedToken = await checkToken(token);
      if (!checkedToken) {
        window.location.href = "../login.html";
      }
    };

    async function checkToken(token) {
      let url = "http://localhost:5025/api/Account/CheckToken";
      const response = await fetch(url, {
        method: "POST",
        headers: {
          "Content-Type": "application/json",
          Authorization: "Bearer " + token,
        },
        body: null,
      });
      if (response.ok) {
        return true;
      } else {
        return false;
      }
    }

    async function CreateFolder() {
      try {
        let folderName = document.getElementById("file-name").value;
        if (!folderName || folderName.trim() === "") {
          toastr.error("Please enter a folder name");
          return;
        }
        const token = localStorage.getItem("token");
        if (!token) {
          toastr.error("You must be logged in");
          window.location.href = "../login.html";
          return;
        }
        let url = "http://localhost:5025/api/Folder";
        const response = await fetch(url, {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
            Authorization: "Bearer " + token,
          },
          body: JSON.stringify({
            name: folderName.trim()
          }),
        });
        if (response.ok) {
          try {
            const data = await response.json();
            toastr.success("Folder created successfully!");
          } catch (e) {
            toastr.success("Folder created successfully!");
            window.location.href = "all.html";
          }
          document.getElementById("file-name").value = "";
        }
      } catch (error) {
        console.error("Error creating folder:", error);
        toastr.error("Network error. Please check your connection and try again.");
      }
    }
  </script>
</body>

</html>